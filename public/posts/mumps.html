<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>MUMPS | Awesome Installation</title>
  <meta name="author" content="Nick">
  
  <meta name="description" content="下载下载,需要上下面的网站去预留信息，然后开发者会在几小时内将软件发至你留的邮箱中，建议下载最新版本5.1.1。
源码：http://graal.ens-lyon.fr/MUMPS/ , 如果该链接无法访问，请访问 https://launchpad.net/ubuntu/+source/mumps">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="MUMPS"/>
  <meta property="og:site_name" content="Awesome Installation"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/awesome-installation/atom.xml" title="Awesome Installation" type="application/atom+xml">
  
  
    <link href="/awesome-installation/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/awesome-installation/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/awesome-installation/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/awesome-installation/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/awesome-installation/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/awesome-installation/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/awesome-installation/css/responsive.css" media="screen" type="text/css">  
  <link rel="stylesheet" href="/awesome-installation/css/sidenav.css" media="screen" type="text/css">  
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/awesome-installation/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  

</head>

<body id="body" data-spy="scroll" data-target=".toc">
  <div class="container" id="container">
	<div class="content">
	  <div class="page-header">		
  <h1><a class="brand" href="/awesome-installation/">Awesome Installation</a><span class="split"></span><span class="title">MUMPS</span><span class="date" id="title-date"><i class="fa fa-clock-o"></i> 2016-05-22</span></h1>
</div>		

<div class="row page">
  <!-- cols -->	
  
  <div class="col-xs-12 col-sm-3 col-md-3 toc"> 
	<!-- toc -->
<script type="text/javascript">
		jQuery(document).ready(function() {
 		   generateWikiTOC('.note', '.toc',  2 , 2 );
		});
</script>
  </div><!-- col-md-3 -->
  
  

  
  <div class="col-xs-12 col-sm-9 col-md-9 note">
	

	  <!-- content -->
	  <h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p>下载,需要上下面的网站去预留信息，然后开发者会在几小时内将软件发至你留的邮箱中，建议下载最新版本5.1.1。</p>
<p>源码：<a href="http://graal.ens-lyon.fr/MUMPS/" target="_blank" rel="noopener">http://graal.ens-lyon.fr/MUMPS/</a> , 如果该链接无法访问，请访问 <a href="https://launchpad.net/ubuntu/+source/mumps/5.1.1-2" target="_blank" rel="noopener">https://launchpad.net/ubuntu/+source/mumps/5.1.1-2</a> , 该网页中有个名为<code>mumps_5.1.1.orig.tar.gz</code>,下载该文件即可。</p>
<h2 id="基本依赖包"><a href="#基本依赖包" class="headerlink" title="基本依赖包"></a>基本依赖包</h2><p>安装MUMPS有三种方式，一种是只安装单核版(sequential version);一种是安装多核版(multicore machine)；最后一种是并行版(parallel version).由于笔者安装MUMPS的主要目的是用于FWI，因此对于运行速度要求很高，在此选择并行版进行安装。其它方式的安装比较简单，读者可自行尝试。</p>
<p>安装并行版MUMPS需要以下一些依赖包</p>
<ul>
<li><p>MPI</p>
</li>
<li><p>BLAS library</p>
</li>
<li><p>BLACS library</p>
</li>
<li><p>ScaLAPACK library</p>
</li>
</ul>
<p>其中 MPI 一般有两种 MPICH 和 OPENMPI, 安装 MPICH <a href="mpich.html">请点击这里</a>；至于BLAS，BLACS，ScaLAPACK 这三个库可使用 Intel 的 MKL 库，因此需要安装 intel 的编译器，<a href="intel.html">请点击这里</a>。</p>
<h3 id="解压"><a href="#解压" class="headerlink" title="解压"></a>解压</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ tar zxvf MUMPS_5.1.1.tar.gz</span><br><span class="line">$ cd MUMPS_5.1.1</span><br></pre></td></tr></table></figure>
<h3 id="修改Makefile-inc"><a href="#修改Makefile-inc" class="headerlink" title="修改Makefile.inc"></a>修改Makefile.inc</h3><p>安装好intel编译器后，在此可直接复制 <code>Make.inc/</code> 目录下的 <code>Makefile.INTEL.PAR</code> 文件至 MUMPS 的根目录，并修改一些参数使之与自己的系统相符。</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cp Make.inc/Makefile.INTEL.PAR ./Makefile.inc</span></span><br></pre></td></tr></table></figure>
<p>由于 MUMPS 需要依赖与 METIS 或 SCOTCH 来划分网格，两种选一种即可，此处选择的是 METIS，下载 METIS 并编译好 METIS 后，需要修改刚才的<code>Makefile.inc</code>文件，具体改动如下：</p>
<p>去掉<code>LMETISDIR</code>和<code>LMETIS</code>前的注释，并根据自己METIS的安装情况给其赋值，然后，在添加<code>-Dmetis</code>在<code>ORDERINGSF</code>之后。 例如：</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  This file is part of MUMPS 5.1.1, released</span></span><br><span class="line"><span class="comment">#  on Mon Mar 20 14:34:33 UTC 2017</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#Begin orderings</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># NOTE that PORD is distributed within MUMPS by default. It is recommended to</span></span><br><span class="line"><span class="comment"># install other orderings. For that, you need to obtain the corresponding package</span></span><br><span class="line"><span class="comment"># and modify the variables below accordingly.</span></span><br><span class="line"><span class="comment"># For example, to have Metis available within MUMPS:</span></span><br><span class="line"><span class="comment">#          1/ download Metis and compile it</span></span><br><span class="line"><span class="comment">#          2/ uncomment (suppress # in first column) lines</span></span><br><span class="line"><span class="comment">#             starting with LMETISDIR,  LMETIS</span></span><br><span class="line"><span class="comment">#          3/ add -Dmetis in line ORDERINGSF</span></span><br><span class="line"><span class="comment">#             ORDERINGSF  = -Dpord -Dmetis</span></span><br><span class="line"><span class="comment">#          4/ Compile and install MUMPS</span></span><br><span class="line"><span class="comment">#             make clean; make   (to clean up previous installation)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#          Metis/ParMetis and SCOTCH/PT-SCOTCH (ver 6.0 and later) orderings are recommended.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#SCOTCHDIR  = $&#123;HOME&#125;/scotch_6.0</span></span><br><span class="line"><span class="comment">#ISCOTCH    = -I$(SCOTCHDIR)/include</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># You have to choose one among the following two lines depending on</span></span><br><span class="line"><span class="comment"># the type of analysis you want to perform. If you want to perform only</span></span><br><span class="line"><span class="comment"># sequential analysis choose the first (remember to add -Dscotch in the ORDERINGSF</span></span><br><span class="line"><span class="comment"># variable below); for both parallel and sequential analysis choose the second</span></span><br><span class="line"><span class="comment"># line (remember to add -Dptscotch in the ORDERINGSF variable below)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#LSCOTCH    = -L$(SCOTCHDIR)/lib -lesmumps -lscotch -lscotcherr</span></span><br><span class="line"><span class="comment">#LSCOTCH    = -L$(SCOTCHDIR)/lib -lptesmumps -lptscotch -lptscotcherr</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">LPORDDIR = <span class="variable">$(topdir)</span>/PORD/lib/</span><br><span class="line">IPORD    = -I<span class="variable">$(topdir)</span>/PORD/<span class="keyword">include</span>/</span><br><span class="line">LPORD    = -L<span class="variable">$(LPORDDIR)</span> -lpord</span><br><span class="line"></span><br><span class="line"><span class="comment">################## 修改部位1 ###################</span></span><br><span class="line">LMETISDIR = <span class="variable">$(HOME)</span>/software/metis/lib</span><br><span class="line">IMETIS    = <span class="variable">$(HOME)</span>/software/metis/<span class="keyword">include</span></span><br><span class="line"><span class="comment">###############################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># You have to choose one among the following two lines depending on</span></span><br><span class="line"><span class="comment"># the type of analysis you want to perform. If you want to perform only</span></span><br><span class="line"><span class="comment"># sequential analysis choose the first (remember to add -Dmetis in the ORDERINGSF</span></span><br><span class="line"><span class="comment"># variable below); for both parallel and sequential analysis choose the second</span></span><br><span class="line"><span class="comment"># line (remember to add -Dparmetis in the ORDERINGSF variable below)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################## 修改部位2 ###################</span></span><br><span class="line">LMETIS    = -L<span class="variable">$(LMETISDIR)</span> -lmetis</span><br><span class="line"><span class="comment">#LMETIS    = -L$(LMETISDIR) -lparmetis -lmetis</span></span><br><span class="line"><span class="comment">###############################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The following variables will be used in the compilation process.</span></span><br><span class="line"><span class="comment"># Please note that -Dptscotch and -Dparmetis imply -Dscotch and -Dmetis respectively.</span></span><br><span class="line"><span class="comment"># If you want to use Metis 4.X or an older version, you should use -Dmetis4 instead of -Dmetis</span></span><br><span class="line"><span class="comment"># or in addition with -Dparmetis (if you are using parmetis 3.X or older).</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################## 修改部位3 ###################</span></span><br><span class="line"><span class="comment">#ORDERINGSF = -Dscotch -Dmetis -Dpord -Dptscotch -Dparmetis</span></span><br><span class="line">ORDERINGSF  = -Dpord -Dmetis</span><br><span class="line">ORDERINGSC  = <span class="variable">$(ORDERINGSF)</span></span><br><span class="line"><span class="comment">###############################################</span></span><br><span class="line"></span><br><span class="line">LORDERINGS = <span class="variable">$(LMETIS)</span> <span class="variable">$(LPORD)</span> <span class="variable">$(LSCOTCH)</span></span><br><span class="line">IORDERINGSF = <span class="variable">$(ISCOTCH)</span></span><br><span class="line">IORDERINGSC = <span class="variable">$(IMETIS)</span> <span class="variable">$(IPORD)</span> <span class="variable">$(ISCOTCH)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#End orderings</span></span><br><span class="line"><span class="comment">########################################################################</span></span><br><span class="line"><span class="comment">################################################################################</span></span><br><span class="line"></span><br><span class="line">PLAT    =</span><br><span class="line">LIBEXT  = .a</span><br><span class="line">OUTC    = -o</span><br><span class="line">OUTF    = -o</span><br><span class="line">RM = /bin/rm -f</span><br><span class="line">CC = mpiicc</span><br><span class="line">FC = mpiifort</span><br><span class="line">FL = mpiifort</span><br><span class="line">AR = ar vr</span><br><span class="line"><span class="comment">#RANLIB = ranlib</span></span><br><span class="line">RANLIB  = echo</span><br><span class="line"><span class="comment"># Make this variable point to the path where the Intel MKL library is</span></span><br><span class="line"><span class="comment"># installed. It is set to the default install directory for Intel MKL.</span></span><br><span class="line">MKLROOT=/opt/intel/mkl/lib/intel64</span><br><span class="line">LAPACK = -L<span class="variable">$(MKLROOT)</span> -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core</span><br><span class="line">SCALAP = -L<span class="variable">$(MKLROOT)</span> -lmkl_scalapack_lp64 -lmkl_blacs_intelmpi_lp64</span><br><span class="line"></span><br><span class="line">LIBPAR = <span class="variable">$(SCALAP)</span> <span class="variable">$(LAPACK)</span></span><br><span class="line"></span><br><span class="line">INCSEQ = -I<span class="variable">$(topdir)</span>/libseq</span><br><span class="line">LIBSEQ  = <span class="variable">$(LAPACK)</span> -L<span class="variable">$(topdir)</span>/libseq -lmpiseq</span><br><span class="line"></span><br><span class="line">LIBBLAS = -L<span class="variable">$(MKLROOT)</span> -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core</span><br><span class="line">LIBOTHERS = -lpthread</span><br><span class="line"></span><br><span class="line"><span class="comment">#Preprocessor defs for calling Fortran from C (-DAdd_ or -DAdd__ or -DUPPER)</span></span><br><span class="line">CDEFS   = -DAdd_</span><br><span class="line"></span><br><span class="line"><span class="comment">#Begin Optimized options</span></span><br><span class="line">OPTF    = -O -nofor_main -qopenmp <span class="comment"># or -openmp for old compilers</span></span><br><span class="line">OPTL    = -O -nofor_main -qopenmp</span><br><span class="line">OPTC    = -O -qopenmp</span><br><span class="line"><span class="comment">#End Optimized options</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################## 修改部位4 ###################</span></span><br><span class="line">INCS = <span class="variable">$(INCPAR)</span> -I<span class="variable">$(IMETIS)</span></span><br><span class="line"><span class="comment">###############################################</span></span><br><span class="line"></span><br><span class="line">LIBS = <span class="variable">$(LIBPAR)</span></span><br><span class="line">LIBSEQNEEDED =</span><br></pre></td></tr></table></figure>
<h3 id="Compilation"><a href="#Compilation" class="headerlink" title="Compilation"></a>Compilation</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ make alllib</span><br></pre></td></tr></table></figure>
<p>编译完成后，可以在MUMPS的安装目录下发现有目录lib/,该目录主要用于链接外部函数调用此库文件。<br><div class="alert alert-warning"><i class="fa fa-bell"></i>  运行 `make alllib` 之后，可能会报错，错误信息为'ar: two different operation options specified'，其主要原因在于 Makefile.inc 文件中 AR 变量的设置存在问题。需要在后面补充一个空格符，即可完成正常安装。</div></p>
	  

	  <div>
  		<center>
		  <div class="pagination">
<ul class="pagination">
	
	
	
	
	
	
		
	
		
	
		
	
		
	
		
	
		
	
		
			
		
	
		
			
			
		
	
		
			
			
			
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
		
	
	
	
		<li class="prev"><a href="/awesome-installation/posts/scotch.html" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>prev</a></li>
	
	<li><a href="/awesome-installation/"><i class="fa fa-archive"></i>Home</a></li>
	
		<li class="next"><a href="/awesome-installation/posts/metis.html" class="alignright next">next<i class="fa fa-arrow-circle-o-right"></i></a></li>
	
</ul>
</div>

		</center>
	  </div>
	  
	</div> <!-- col-md-9/col-md-12 -->
	
  </div><!-- row -->

	</div>
  </div>
  <div class="container-narrow">
	<footer> <p>
  &copy; 2018 Nick
  
      with help from <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-wixo/">Wixo</a>.    
</p> </footer>
  </div> <!-- container-narrow -->
  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/awesome-installation/js/jquery.imagesloaded.min.js"></script>
<script src="/awesome-installation/js/gallery.js"></script>
<script src="/awesome-installation/js/bootstrap.min.js"></script>
<script src="/awesome-installation/js/jquery.tableofcontents.min.js"></script>
<script src="/awesome-installation/js/tocgenerator.min.js"></script>
<script src="/awesome-installation/js/main.js"></script>
<script src="/awesome-installation/js/search.js"></script> 




<link rel="stylesheet" href="/awesome-installation/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/awesome-installation/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/awesome-installation/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>


</body>
</html>
